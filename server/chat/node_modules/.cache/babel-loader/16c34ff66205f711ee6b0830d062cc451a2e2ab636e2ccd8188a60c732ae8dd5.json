{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Documents/web developing/exercises/3/final server/Chat-Application/chat/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/User/Documents/web developing/exercises/3/final server/Chat-Application/chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Documents/web developing/exercises/3/final server/Chat-Application/chat/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Link,useNavigate}from'react-router-dom';import{useState}from'react';import PasswordLog from'./password/PasswordLog.js';import UsernameLog from'./userName/UsernameLog.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LogIn(_ref){var setUser=_ref.setUser;var navigate=useNavigate();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isCorrect=_useState2[0],setIsCorrect=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var userDetails,res,respond,user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();userDetails={\"username\":name,\"password\":password};_context.next=4;return fetch('http://localhost:5000/api/Tokens',{'method':'post','headers':{'Content-Type':'application/json'},'body':JSON.stringify(userDetails)});case 4:res=_context.sent;if(!(res.status!==200)){_context.next=9;break;}setIsCorrect(false);_context.next=22;break;case 9:_context.next=11;return res.text();case 11:userDetails.token=_context.sent;_context.next=14;return fetch('http://localhost:5000/api/Users/'+userDetails.username,{'headers':{'Content-Type':'application/json','authorization':'bearer '+userDetails.token}});case 14:respond=_context.sent;_context.next=17;return respond.json();case 17:user=_context.sent;user.registered=\"yes\";user.token=userDetails.token;setUser(user);navigate('/chat');case 22:case\"end\":return _context.stop();}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"patterns sea\"}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid\",id:\"log-screen\",children:[/*#__PURE__*/_jsx(UsernameLog,{setVal:setName}),/*#__PURE__*/_jsx(PasswordLog,{setVal:setPassword}),!isCorrect&&/*#__PURE__*/_jsx(\"div\",{className:\"lable alert alert-danger\",children:\"Incorrect username or password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary screen-foot\",id:\"login\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"screen-foot\",id:\"register\",children:[\"Not registered? \",/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"click here\"}),\" to register\"]})]})})]});}export default LogIn;","map":{"version":3,"names":["Link","useNavigate","useState","PasswordLog","UsernameLog","jsx","_jsx","jsxs","_jsxs","LogIn","_ref","setUser","navigate","_useState","_useState2","_slicedToArray","isCorrect","setIsCorrect","_useState3","_useState4","name","setName","_useState5","_useState6","password","setPassword","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","userDetails","res","respond","user","wrap","_callee$","_context","prev","next","preventDefault","fetch","JSON","stringify","sent","status","text","token","username","json","registered","stop","children","className","onSubmit","id","setVal","type","to"],"sources":["C:/Users/User/Documents/web developing/exercises/3/final server/Chat-Application/chat/src/log-in/Log-in.js"],"sourcesContent":["import { Link, useNavigate } from 'react-router-dom';\r\nimport { useState } from 'react';\r\nimport PasswordLog from './password/PasswordLog.js';\r\nimport UsernameLog from './userName/UsernameLog.js';\r\n\r\nfunction LogIn({setUser}) {\r\n    const navigate = useNavigate();\r\n    const [isCorrect, setIsCorrect] = useState(true);\r\n    const [name, setName] = useState(null);\r\n    const [password, setPassword] = useState(null);\r\n\r\n    async function handleSubmit(event) {\r\n      event.preventDefault();\r\n      const userDetails = {\r\n        \"username\": name,\r\n        \"password\": password\r\n      };\r\n      const res = await fetch('http://localhost:5000/api/Tokens', {\r\n        'method': 'post',\r\n        'headers': {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        'body': JSON.stringify(userDetails)\r\n      });\r\n    \r\n      if (res.status !== 200) {\r\n        setIsCorrect(false);\r\n      } else {\r\n        \r\n        userDetails.token = await res.text();\r\n          const respond = await fetch('http://localhost:5000/api/Users/' + userDetails.username, {\r\n          'headers': {\r\n          'Content-Type': 'application/json',\r\n          'authorization': 'bearer ' + userDetails.token\r\n            },\r\n          }\r\n                  )\r\n         // Show the server's response\r\n          const user = await respond.json()\r\n          user.registered = \"yes\"\r\n          user.token = userDetails.token\r\n          setUser(user);\r\n          navigate('/chat');\r\n      }\r\n    }\r\n      \r\n    return (\r\n        <div>\r\n            {\r\n        //<!--background like sea-->\r\n        }\r\n        <div className=\"patterns sea\"></div>\r\n        <form onSubmit={handleSubmit}>\r\n{\r\n            //<!--the log in screen-->\r\n            }\r\n            <div className=\"container-fluid\" id=\"log-screen\">\r\n                    {\r\n                    //<!--Username lable-->\r\n}\r\n\r\n                <UsernameLog setVal={setName} />\r\n    {\r\n                //<!--password lable-->\r\n    }\r\n                <PasswordLog setVal={setPassword}/>\r\n                {\r\n                    !isCorrect &&(\r\n                        <div className=\"lable alert alert-danger\">\r\n                            Incorrect username or password\r\n                </div>\r\n                    )\r\n                }\r\n    {\r\n                //<!--login botton-->\r\n    }\r\n                <button type=\"submit\" className=\"btn btn-primary screen-foot\" id=\"login\">Login</button>\r\n               {\r\n                //<!--link to register-->\r\n               }\r\n            <span className=\"screen-foot\" id=\"register\">Not registered? <Link to=\"/\">click here</Link> to register</span>\r\n            </div>\r\n        </form>\r\n    </div>\r\n    );\r\n  }\r\n  \r\n  export default LogIn;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}